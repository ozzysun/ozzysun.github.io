(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{2796:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return o}));const n=t=>({id:t.id,product:t,qty:1,taste:{},toppings:[],capacity:""}),i=(t,e)=>{let a=null;return t.forEach((t=>{t.id===e.id&&(a=t)})),a},s=t=>t.add&&t.add>0?`${t.name}(+${t.add})`:t.name,r=(t,e,a)=>{let n=null;return t.taste.forEach((t=>{t.id===e&&t.items.forEach((t=>{t.id===a&&(n=t)}))})),null!==n?s(n):""},o=(t,e,a,n)=>{let s=!1;const r=i(t,e);return null!==r&&null!==r&&r[a]&&-1!==r[a].indexOf(n)&&(s=!0),s}},a3a5:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"e",(function(){return r})),a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return l}));var n=a("2796");const i=t=>{const e=[];for(const a in t.taste)t.product.taste.forEach((i=>{i.id===a&&e.push(`${i.name}(${Object(n["d"])(t.product,a,t.taste[a])})`)}));return t.toppings.length>0&&t.toppings.forEach((a=>{t.product.toppings.forEach((t=>{t.id===a&&e.push(t.name)}))})),""!==t.capacity&&t.product.capacity.forEach((a=>{a.id===t.capacity&&e.push(a.name)})),e.join(",")},s=t=>{let e=t.product.price;for(const a in t.taste){const n=t.taste[a];t.product.taste.forEach((t=>{t.id===a&&t.items.forEach((t=>{t.id===n&&void 0!==t.add&&t.add>0&&(e+=t.add)}))}))}return t.toppings.length>0&&t.toppings.forEach((a=>{t.product.toppings.forEach((t=>{t.id===a&&void 0!==t.add&&(e+=t.add)}))})),""!==t.capacity&&t.product.capacity.forEach((a=>{a.id===t.capacity&&void 0!==a.add&&(e+=a.add)})),e*t.qty},r=t=>{let e=0,a=0;return t.forEach((t=>{e+=s(t),a+=t.qty})),{totalPrice:e,count:t.length,itemsCount:a}},o=(t,e)=>{let a=null,n=null;return t.forEach((t=>{void 0!==e&&t.id===e&&(a=t),t.default&&(n=t)})),null===a&&null!==n&&(a=n),a},l=(t,e)=>{let a=null,n=null;return t.forEach((t=>{void 0!==e&&t.id===e&&(a=t),t.default&&(n=t)})),null===a&&null!==n&&(a=n),a}},efea:function(t,e,a){"use strict";a("ddb0"),a("e6cf");var n=a("2b0e");let i=null;null===i&&(i=new n["a"]({data(){return{classNames:[]}},methods:{on(t,e,a){if(Object.defineProperty(a,"fnName",{value:e}),void 0===this._events[t])this.$on(t,a);else{let n=!1;for(let i=0;i<this._events[t].length;i++)if(this._events[t][i].fnName===e){n=!0,this._events[t][i]=a;break}n||this.$on(t,a)}},emit(t,...e){this.$emit(t,...e)},off(t,e){this.$off(t)}}}));var s,r,o=i,l=a("71f5"),c=a("7b12"),d=a("2ef0"),h=a.n(d),u={name:"VComponent",data(){return{}},computed:{params(){return this.$route.params},uid(){return`uid_${this._uid}`},id(){let t=void 0===this.$el||void 0===this.$el.getAttribute?null:this.$el.getAttribute("id");return void 0!==this.$attrs&&this.$attrs.id&&(t=this.$attrs.id),t},query(){return this.$route.query}},methods:{addModalHandler(t=null){this.on("Modal.DispatchData",((e,a,n=null)=>{null!==n&&n!==this.id||(null===t?this.modalHandler(e,a):t(e,a))}))},modalHandler(t,e,a=null){},showModal(t,e=null,a=null,n=!1){null!==e&&this.setModalData(e),this.emit("Modal.CMD.Show",t,!0,a,n)},setModalData(t){Object(l["d"])("modalData",t,"tmp")},haveModalData(){return null!==Object(l["b"])("modalData","tmp")},getModalData(){const t=h.a.cloneDeep(Object(l["b"])("modalData","tmp"));return Object(l["c"])("modalData","tmp"),t},hideModal(t){this.emit("Modal.CMD.Show",t,!1)},on(t,...e){let a,n;const i=t.split(",");1===e.length?(a=e[0],n=this.id):2===e.length&&(n=e[0],a=e[1]);for(let s=0;s<i.length;s++)o.on(i[s],n,a)},emit(t,...e){o.emit(t,...e)},off(t,e){o.off(t,e)},async fetch(t,...e){const a=Object(c["b"])();return new Promise(((n,i)=>{a[t](...e).then((t=>{n(t)})).catch((t=>{i(t)}))}))},fetchSync(t,...e){const a=Object(c["b"])(),n=e.pop();a[t](...e).then((t=>{n(null,t)})).catch((t=>{n(t,t)}))},async fetchURL(t,e="GET",a=null){return new Promise(((n,i)=>{Object(c["a"])(t,e,a).then((t=>{n(t)})).catch((t=>{i(t)}))}))},async dispatch(t,...e){return new Promise(((a,n)=>{const i=1===e.length?e[0]:e;this.$store.dispatch(t,i).then((t=>{a(t)})).catch((t=>{n(t)}))}))},to(t){this.$router.push(t)},setReactive(t,e){this[t]=Object.assign({},e,e)},trace(t){console.log(t)},alert(t,e="",a=null){this.$q.dialog({title:e,message:t}).onOk((()=>{null!==a&&a()})).onCancel((()=>{})).onDismiss((()=>{}))},confirm(t,e="",a=null){this.$q.dialog({title:e,message:t,cancel:!0,persistent:!0}).onOk((()=>{null!==a&&a()})).onOk((()=>{})).onCancel((()=>{})).onDismiss((()=>{}))}}},m=u,p=a("2877"),b=Object(p["a"])(m,s,r,!1,null,null,null);e["a"]=b.exports},f81c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"touch-swipe",rawName:"v-touch-swipe.mouse.left.right",value:t.handleSwipe,expression:"handleSwipe",modifiers:{mouse:!0,left:!0,right:!0}}]},[a("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(t){return a("q-tab",{key:t.id,attrs:{name:t.id,label:t.name}})})),1),a("q-separator"),a("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"new",scroll:""}},[a("q-list",{staticClass:"q-gutter-sm",staticStyle:{width:"100%"},attrs:{bordered:"",separator:""}},[t._l(t.newItems,(function(t){return a("order-item",{key:t.orderId,attrs:{item:t}})})),a("q-item",[a("q-space"),a("q-space")],1)],2)],1),a("q-tab-panel",{attrs:{name:"finish",scroll:""}},[a("q-list",{staticClass:"q-gutter-sm",staticStyle:{width:"100%"},attrs:{bordered:"",separator:""}},[t._l(t.finishItems,(function(t){return a("order-item",{key:t.orderId,attrs:{item:t}})})),a("q-item",[a("q-space"),a("q-space")],1)],2)],1)],1)],1)},i=[],s=a("4082"),r=a.n(s),o=a("ded3"),l=a.n(o),c=(a("e6cf"),a("efea")),d=a("2f62"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-expansion-item",{attrs:{"header-class":"bg-white text-black","dense-toggle":!0},scopedSlots:t._u([{key:"header",fn:function(){return[null!==t.info?a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{color:t.theme,"text-color":"white"}},[t._v("\n        "+t._s(t.getTableItem(t.info.tables,t.item.clientInfo.tableId).name)+"\n      ")]),a("q-item-label",{staticClass:"q-pl-xs"},[t._v("\n        "+t._s(t.getWayItem(t.info.ways,t.item.clientInfo.way).name)+"\n      ")])],1):t._e(),a("q-item-section",[a("q-item-label",[t._v(t._s(t.dayjs(t.item.created).format("YYYY-MM-DD HH:mm")))]),a("q-item-label",{attrs:{caption:"",lines:"1"}},[t._v("單號："+t._s(t.item.orderId))])],1),a("q-item-section",{attrs:{side:""}},[a("q-item-label",{staticClass:"text-bold",attrs:{lines:"1"}},[t._v("\n        金額："+t._s(t.orderInfo(t.item.items).totalPrice)+"\n      ")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n        "+t._s(t.item.checked?"已付款":"尚未付款")+"\n      ")])],1)]},proxy:!0}])},[a("q-card",{class:"bg-grey-3"},[a("q-card-section",[a("q-list",[t._l(t.item.items,(function(e){return a("q-item",{key:e.id},[a("q-item-section",{staticClass:"q-ml-none",attrs:{top:"",thumbnail:""}},[a("img",{attrs:{src:e.product.img}})]),a("q-item-section",[a("q-item-label",[t._v("\n              "+t._s(e.product.name)+"\n            ")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n              "+t._s(t.getSubItemInfo(e))+"\n            ")])],1),a("q-item-section",{attrs:{side:"",center:""}},[a("q-item-label",{attrs:{caption:""}},[t._v("$"+t._s(e.product.price)+"x"+t._s(e.qty))]),a("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.getItemPrice(e)))])],1)],1)})),a("q-separator")],2)],1),a("q-card-section",[a("q-item-section",{attrs:{side:"",top:""}},[a("q-item-label",{attrs:{caption:""}},[a("q-checkbox",{attrs:{val:t.item.id,color:t.theme,label:"已完成"},on:{input:function(e){return t.changeHandler(t.item)}},model:{value:t.item.completed,callback:function(e){t.$set(t.item,"completed",e)},expression:"item.completed"}}),a("q-checkbox",{attrs:{val:t.item.id,color:t.theme,label:"已付款"},on:{input:function(e){return t.changeHandler(t.item)}},model:{value:t.item.checked,callback:function(e){t.$set(t.item,"checked",e)},expression:"item.checked"}})],1)],1)],1)],1)],1)},u=[],m=a("5a0c"),p=a.n(m),b=a("a3a5"),f={name:"OrderItem",extends:c["a"],props:{item:{type:Object,default:null}},data(){return{info:null}},computed:l()({},Object(d["b"])(["shop","branch","theme","theme"])),async created(){this.info=await this.getShopInfo(this.item.shop,this.item.branch)},watch:{},methods:{dayjs:p.a,orderInfo:b["e"],getWayItem:b["d"],getTableItem:b["c"],getItemPrice:b["a"],getSubItemInfo:b["b"],async getShopInfo(t,e){const a=await this.dispatch("GetShopInfo",{shop:t,branch:e});return a},changeHandler(t){this.dispatch("UpdateHistoryOrderStatus",t)}}},g=f,q=a("2877"),v=a("3b73"),y=a("4074"),I=a("cb32"),w=a("0170"),_=a("f09f"),x=a("a370"),$=a("1c1c"),k=a("66e5"),E=a("eb85"),O=a("8f8e"),S=a("9c40"),j=a("eebe"),Q=a.n(j),D=Object(q["a"])(g,h,u,!1,null,null,null),C=D.exports;Q()(D,"components",{QExpansionItem:v["a"],QItemSection:y["a"],QAvatar:I["a"],QItemLabel:w["a"],QCard:_["a"],QCardSection:x["a"],QList:$["a"],QItem:k["a"],QSeparator:E["a"],QCheckbox:O["a"],QBtn:S["a"]});var M={name:"KDSPge",extends:c["a"],components:{orderItem:C},data(){return{allItems:[],tabs:[{id:"new",name:"新訂單"},{id:"finish",name:"已完成"}],tab:"new"}},async created(){this.allItems=await this.dispatch("GetOrderList",{shop:this.shop,branch:this.branch,date:"20210401"})},computed:l()(l()({},Object(d["b"])(["shop","branch","theme","shopInfo"])),{},{newItems(){const t=[];return this.allItems.forEach((e=>{e.shop===this.shop&&e.branch===this.branch&&(e.completed||t.push(e))})),t},finishItems(){const t=[];return this.allItems.forEach((e=>{e.shop===this.shop&&e.branch===this.branch&&e.completed&&t.push(e)})),t}}),watch:{allItems(t){}},methods:{handleSwipe(t){let{evt:e}=t,a=r()(t,["evt"]);"left"===a.direction?this.nextTab(!1):this.prevTab(!1)},nextTab(t=!1){console.log("next tab");let e=0;this.tabs.forEach(((t,a)=>{t.id===this.tab&&(e=a)}));let a=e+1;a>=this.tabs.length&&(a=t?0:this.tabs.length-1),this.tab=this.tabs[a].id},prevTab(t=!1){console.log("prev tab");let e=0;this.tabs.forEach(((t,a)=>{t.id===this.tab&&(e=a)}));let a=e-1;a<0&&(a=t?this.tabs.length-1:0),this.tab=this.tabs[a].id}}},T=M,P=a("429b"),H=a("7460"),L=a("adad"),N=a("823b"),Y=a("2c91"),A=a("12c5"),G=Object(q["a"])(T,n,i,!1,null,"be8cb54a",null);e["default"]=G.exports;Q()(G,"components",{QTabs:P["a"],QTab:H["a"],QSeparator:E["a"],QTabPanels:L["a"],QTabPanel:N["a"],QList:$["a"],QItem:k["a"],QSpace:Y["a"]}),Q()(G,"directives",{TouchSwipe:A["a"]})}}]);